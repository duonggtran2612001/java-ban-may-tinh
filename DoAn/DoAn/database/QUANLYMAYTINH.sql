CREATE DATABASE QUANLYMAYTINH
GO

USE QUANLYMAYTINH
GO

CREATE TABLE KHACHHANG
(
	MAKH INT IDENTITY(1,1) PRIMARY KEY,
	HOTEN NVARCHAR(50),
	SDT NVARCHAR(10),
	DCHI NVARCHAR(100),
	EMAIL NVARCHAR(100)
)
GO

CREATE TABLE LOAISANPHAM
(
	MALOAISP int PRIMARY KEY,
	LOAISP NVARCHAR(50)
)
GO

CREATE TABLE SANPHAM
(
	MASP NVARCHAR(10) PRIMARY KEY,
	TENSP NVARCHAR(50),
	MALOAISP int,
	GIA MONEY,
	SOLUONG INT
)
GO

CREATE TABLE NHANVIEN
(
	MANV INT IDENTITY(1,1) PRIMARY KEY,
	TENNV NVARCHAR(50),
	SDT NVARCHAR(10),
	DCHI NVARCHAR(100),
	TENDANGNHAP NVARCHAR(50),
	MATKHAU NVARCHAR(50),
	LOAINV INT
)
GO

CREATE TABLE HOADONBAN
(
	MAHDB INT IDENTITY(1,1) PRIMARY KEY,
	MAKH INT,
	MANV INT,
	NGHDB DATE,
	TONGTIEN MONEY
)
GO

CREATE TABLE CTHDBAN
(
	MAHDB INT,
	MASP NVARCHAR(10),
	SOLUONG INT,
	DONGIA MONEY,
	THANHTIEN MONEY
	PRIMARY KEY(MAHDB,MASP)
)
GO

CREATE TABLE DICHVU
(
	MADV INT PRIMARY KEY,
	TENDV NVARCHAR(50)
)
GO

CREATE TABLE HOADONDICHVU
(
	MAHDDV INT IDENTITY(1,1) PRIMARY KEY,
	MAKH INT,
	MANV INT,
	NGHDDV DATE,
	TONGTIEN MONEY
)
GO

CREATE TABLE CTHDDV
(
	MAHDDV INT,
	MADV INT,
    TENSP NVARCHAR(50),
	GIA MONEY
	PRIMARY KEY(MAHDDV,MADV,TENSP)
)
GO

CREATE TABLE NHACUNGCAP
(
	MANCC INT IDENTITY(1,1) PRIMARY KEY,
	TENNCC NVARCHAR(50),
	SDT NVARCHAR(10),
	DIACHI NVARCHAR(100)
)
GO

CREATE TABLE PHIEUNHAP
(
	MAPN INT IDENTITY(1,1) PRIMARY KEY,
	MANCC INT,
	MANV INT,
	NGPN DATE,
	TONGTIEN MONEY 
)
GO

CREATE TABLE CTPN
(
	MAPN INT,
	MASP NVARCHAR(10),
	SOLUONG INT,
	DONGIA MONEY,
	THANHTIEN MONEY
	PRIMARY KEY(MAPN,MASP)
)
GO

ALTER TABLE PHIEUNHAP
ADD CONSTRAINT FKPN_NCC
FOREIGN KEY (MANCC)
REFERENCES NHACUNGCAP(MANCC)

ALTER TABLE CTPN
ADD CONSTRAINT FKCTPN_PN
FOREIGN KEY (MAPN)
REFERENCES PHIEUNHAP(MAPN)

ALTER TABLE CTPN
ADD CONSTRAINT FKCTPN_SP
FOREIGN KEY (MASP)
REFERENCES SANPHAM(MASP)

ALTER TABLE SANPHAM
ADD CONSTRAINT FKSP_LOAISP
FOREIGN KEY (MALOAISP)
REFERENCES LOAISANPHAM(MALOAISP)

ALTER TABLE HOADONBAN
ADD CONSTRAINT FKHDB_KH
FOREIGN KEY (MAKH)
REFERENCES KHACHHANG(MAKH)

ALTER TABLE HOADONBAN
ADD CONSTRAINT FKHDB_NV
FOREIGN KEY (MANV)
REFERENCES NHANVIEN(MANV)

ALTER TABLE CTHDBAN
ADD CONSTRAINT FKCTHDB_HDB
FOREIGN KEY (MAHDB)
REFERENCES HOADONBAN(MAHDB)

ALTER TABLE CTHDBAN
ADD CONSTRAINT FKCTHDB_SP
FOREIGN KEY (MASP)
REFERENCES SANPHAM(MASP)

ALTER TABLE HOADONDICHVU
ADD CONSTRAINT FKHDDV_KH
FOREIGN KEY (MAKH)
REFERENCES KHACHHANG(MAKH)

ALTER TABLE HOADONDICHVU
ADD CONSTRAINT FKHDDV_NV
FOREIGN KEY (MANV)
REFERENCES NHANVIEN(MANV)

ALTER TABLE CTHDDV
ADD CONSTRAINT FKCTHDDV_HDDV
FOREIGN KEY (MAHDDV)
REFERENCES HOADONDICHVU(MAHDDV)

ALTER TABLE CTHDDV
ADD CONSTRAINT FKCTHDDV_DV
FOREIGN KEY (MADV)
REFERENCES DICHVU(MADV)

INSERT INTO NHANVIEN VALUES (N'Hiếu','0931147795',N'Phường 15 Quận 8',N'admin',N'admin',1),
							(N'Lợi','0902756413',N'Phường 14 Quận 8','thanhloi','123',1),
							(N'Lương','0933540383',N'Phường An Lạc Quận Bình Tân',N'user',N'user',0),
							(N'Dương','0901876234',N'Phường 16 Quận 8',N'daiduong',N'123',0)
GO

INSERT INTO KHACHHANG VALUES (N'Trà Nguyễn Hoàng Minh',N'0923768231',N'Quận 8',N'minhhoang@gmail.com'),
							 (N'Âu Dương Bỉnh Hằng',N'0956737453',N'Quận 1',N'hangau101@yahoo.com'),
							 (N'Tạ Tuấn Kiệt',N'0987463827',N'Quận Bình Tân',N'takiet1508@yahoo.com'),
							 (N'Trần Minh Nhật',N'0956838354',N'Quận 6',N'trannhat202@gmail.com'),
							 (N'Nguyễn Thành Tiến',N'0957453112',N'Quận Bình Tân',N'thanhtien1202@gmail.com'),
							 (N'Nguyễn Minh Quân',N'0945323565',N'Quận 8',N'minhquan007@yahoo.com'),
							 (N'Lý Khải Tuấn',N'0975367867',N'Quận Bình Chánh',N'khaituan@yahoo.com'),
							 (N'Lý Hồng Kỳ',N'0933532187',N'Quận 8',N'hongky888@gmail.com'),
							 (N'Võ Trung Hùng',N'0901951774',N'Quận 8',N'hungneko@yahoo.com'),
							 (N'Nguyễn Công Tùng',N'0901545608',N'Quận 8',N'tungahri@gmail.com')
GO

INSERT INTO LOAISANPHAM VALUES (1,N'Laptop'),
							   (2,N'Máy Tính'),
							   (3,N'Phụ Kiện'),
							   (4,N'Linh Kiện')
GO

INSERT INTO SANPHAM VALUES (N'L01',N'Laptop Gaming Asus ROG Strix G15 G513IH HN015W',1,18490000,15),
						   (N'L02',N'Laptop Gaming Acer Nitro 5 Eagle AN515 57 5669',1,18490000,17),
						   (N'L03',N'Laptop Gaming Acer Nitro 5 AN515 45 R86D',1,30000000,19),
						   (N'L04',N'Laptop Gaming MSI GF63 Thin 11UD 628VN',1,23490000,20),
						   (N'L05',N'Laptop Huawei Matebook D15 BOD WDH9',1,17990000,23),
						   (N'L06',N'Laptop Gaming Dell G15 5515 P105F004 70266675',1,27990000,28),
						   (N'L07',N'Laptop Lenovo Legion 5 15ITH6 82JK007SVN',1,32490000,30),
						   (N'L08',N'Laptop Gaming Dell Alienware M15 70262921',1,54000000,10),
						   (N'L09',N'Laptop Asus Zenbook UX325EA KG656W',1,21490000,14),
						   (N'L10',N'Laptop GIGABYTE U4 UD 50S1823SO',1,20490000,20),
						   (N'C01',N'PC Dell Inspiron 3881 MT',2,15000000,14),
						   (N'C02',N'PC Minion i1030',2,8990000,15),
						   (N'C03',N'PC PHANTOM i3060',2,38490000,13),
						   (N'C04',N'PC Dragon X',2,83490000,5),
						   (N'C05',N'PC Avengers Z',2,51490000,10),
						   (N'C06',N'PC Valorant Z',2,51490000,20),
						   (N'C07',N'PC Yuumi M',2,16190000,16),
						   (N'C08',N'PC Homework I3',2,7200000,20),
						   (N'C09',N'PC Homework R5',2,14490000,18),
						   (N'C10',N'PC Homework Pentium',2,6190000,30),
						   (N'PK01',N'Màn hình ASUS TUF GAMING VG27AQ 27" IPS 2K 165Hz',3,9490000,20),
						   (N'PK02',N'Màn hình cong ViewSonic VX3418-2KPC 34" 2K 144Hz',3,10690000,20),
						   (N'PK03',N'Màn hình cong SAMSUNG QLED LC49G95 49" VA 2K 240Hz',3,31990000,10),
						   (N'PK04',N'Tai nghe Razer Kraken Kitty Chroma Quartz',3,4290000,20),
						   (N'PK05',N'Tai nghe Corsair HS70 Pro Wireless Carbon',3,1990000,20),
						   (N'PK06',N'Tai nghe HyperX Cloud II Wireless',3,3490000,21),
						   (N'PK07',N'Bàn phím Razer BlackWidow V3 Green Switch Quartz',3,3590000,15),
						   (N'PK08',N'Bàn phím Razer Blackwidow V3 Tenkeyless',3,2490000,18),
						   (N'PK09',N'Bàn phím Vortex 8700 MultiX Summer',3,2900000,20),
						   (N'PK10',N'Chuột Steelseries Rival 600',3,1790000,20),
						   (N'PK11',N'Chuột Logitech G502 Hero',3,1050000,30),
						   (N'PK12',N'Chuột Gaming Asus ROG Pugio II',3,2390000,15),
						   (N'LK01',N'GIGABYTE H510M H',4,1890000,30),
						   (N'LK02',N'Gigabyte GeForce GTX 1660 SUPER OC 6GB GDDR6',4,9490000,27),
						   (N'LK03',N'Ram PNY XLR8 1x8GB 3200 RGB',4,990000,25),
						   (N'LK04',N'SSD KINGSTON A400 240GB M.2 Sata 3',4,890000,30),
						   (N'LK05',N'HDD WD Black 1TB 7200rpm',4,1990000,23),
						   (N'LK06',N'Tản nước Cooler Master MASTERLIQUID ML360L V2',4,2590000,20),
						   (N'LK07',N'Fan DEEPCOOL CF120 PLUS',4,1150000,22),
						   (N'LK08',N'Intel Core i5 10400F',4,4390000,30),
						   (N'LK09',N'ASUS TUF GAMING B560-PLUS WIFI',4,3990000,20),
						   (N'LK10',N'Ram G.Skill Trident Z 1x8GB RGB 3000',4,1350000,25)
GO

INSERT INTO DICHVU VALUES (1,N'Sửa chữa'),
						  (2,N'Thay linh kiện'),
						  (3,N'Vệ sinh')
GO

set dateformat dmy
GO

INSERT INTO HOADONBAN VALUES (1,1,'06-01-2022',5740000),
							 (2,1,'10-01-2022',16880000),
							 (2,2,'28-01-2022',1990000),
							 (3,1,'10-02-2022',16880000),
							 (4,3,'15-02-2022',4180000),
							 (5,4,'02-03-2022',3590000),
							 (5,4,'19-03-2022',3490000),
							 (6,1,'05-04-2022',17990000),
							 (7,2,'17-04-2022',47980000),
							 (8,1,'23-04-2022',2390000),
							 (9,1,'12-05-2022',1780000),
							 (10,1,'15-05-2022',20490000)
GO

INSERT INTO CTHDBAN VALUES (1,N'LK08',1,54000000,54000000),
						   (1,N'LK10',1,20490000,20490000),
						   (2,N'C10',1,6190000,6190000),
						   (2,N'PK02',1,10690000,10690000),
						   (3,N'PK05',1,1990000,1990000),
						   (4,N'LK03',2,30000000,60000000),   						
						   (4,N'LK07',1,1150000,1150000),
						   (4,N'PK11',1,1050000,1050000),
						   (5,N'L01',1,18490000,18490000),
						   (5,N'C07',1,16190000,16190000),
						   (5,N'PK01',1,9490000,9490000),
						   (6,N'PK07',1,3590000,3590000),
						   (7,N'PK06',1,3490000,3490000),
						   (8,N'L05',1,17990000,17990000),
						   (9,N'C03',1,38490000,38490000),
						   (9,N'PK01',1,9490000,9490000),
						   (10,N'PK12',1,2390000,2390000),
						   (11,N'LK04',2,890000,1780000),
						   (12,N'L10',1,20490000,20490000)
GO

INSERT INTO HOADONDICHVU VALUES (1,1,'03-02-2022',500000),
								(5,4,'05-03-2022',400000),
								(9,2,'12-04-2022',750000),
								(2,3,'16-04-2022',400000),
								(10,1,'15-05-2022',1000000)
GO

INSERT INTO CTHDDV VALUES (1,1,N'Ram G.Skill Trident Z 1x8GB RGB 3000',500000),
						  (2,3,N'Laptop Gaming Asus ROG Strix G15 G513IH HN015W',400000),
						  (3,2,N'PC PHANTOM i3060',750000),
						  (4,3,N'PC Homework Pentium',400000),
						  (5,1,N'Laptop GIGABYTE U4 UD 50S1823SO',750000)
GO

insert INTO NHACUNGCAP VALUES (N'CÔNG TY TNHH QUẢNG TIN',N'0989044022',N'6D3 Chu Văn An, Phường 26, Quận Bình Thạnh, TP. Hồ Chí Minh'),
							  (N'CÔNG TY TNHH TIN HỌC HKC',N'0906711767',N'278 Nguyễn Văn Công, Phường 3, Quận Gò Vấp, Tp. Hồ Chí Minh'),
							  (N'CÔNG TY TNHH TIN HỌC MINH AN',N'0243877777',N'426 Nguyễn Trực, Bích Hòa, Thanh Oai, Tp. Hà Nội '),
							  (N'CÔNG TY TNHH CÔNG NGHỆ MÁY TÍNH AN PHÁT',N'0915996116',N'Số 19, Ngõ 178 Thái Hà - Đống Đa - Tp. Hà Nội'),
							  (N'CÔNG TY TNHH THƯƠNG MẠI CÔNG NGHỆ HQC',N'0984690285',N'115 Đốc Thiết, P.Hưng Bình, TP. Vinh, Tỉnh Nghệ An')
GO

insert INTO PHIEUNHAP VALUES (1,1,'02-03-2022',1156957500),
							 (2,2,'10-03-2022',1914744000),
							 (3,3,'15-03-2022',426597500), 
							 (4,4,'04-04-2022',628108650),
							 (5,1,'05-05-2022',759154500) 
GO

insert INTO CTPN VALUES (1,N'L08',20,51300000,1026000000),
						(1,N'C08',10,6840000,68400000),
						(1,N'LK08',15,4170500,62557500),
						(2,N'PK04',10,4075500,40755000),
						(2,N'L04',20,22315500,446310000),
						(2,N'C04',18,79315500,1427679000),
						(3,N'L10',15,19465500,291982500),
						(3,N'C10',20,5880500,117610000),
						(3,N'PK10',10,1700500,17005000),
						(4,N'LK05',10,1890500,18905000),
						(4,N'L05',13,17090500,222176500),
						(4,N'C05',12,48915500,586986000),
						(5,N'PK06',10,2460500,24605000),
						(5,N'C06',15,3315500,49732500),
						(5,N'LK06',14,48915500,684817000)
GO

SELECT * FROM SANPHAM WHERE TENSP LIKE N'%nước%'